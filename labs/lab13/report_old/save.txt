https://esystem.rudn.ru/pluginfile.php/2843521/mod_resource/content/4/014-firewall.pdf
Основы администрирования операционных систем
Лабораторная работа № 13. Фильтр пакетов
Отчёт
Сергеев Даниил Олегович
Студент
Направление: Прикладная информатика
Российский университет дружбы народов
29 ноября 2025

# Цель работы

Получить навыки настройки пакетного фильтра в Linux.

# Задание

1. Используя firewall-cmd:
– определить текущую зону по умолчанию;
– определить доступные для настройки зоны;
– определить службы, включённые в текущую зону;
– добавить сервер VNC в конфигурацию брандмауэра;

2. Используя firewall-config:
– добавьте службы http и ssh в зону public;
– добавьте порт 2022 протокола UDP в зону public;
– добавьте службу ftp;

3. Выполните задание для самостоятельной работы.

# Ход выполнения лабораторной работы

## Управление брандмауэром с помощью firewall-cmd

Запустим терминал и зайдем в учетную запись администратора (su -). Начнем с изучения текущей конфигурации брандмауэра.

Определим текущую зону по умолчанию:
```bash
firewall-cmd --get-default-zone
```

![Название зоны по умолчанию](image/1.PNG){#fig:001 width=90%}

Сейчас по умолчанию установлена зона ```public```.

Определим доступные для настройки зоны:
```bash
firewall-cmd --get-zones
```

![Доступные зоны firewalld](image/2.PNG){#fig:002 width=90%}

Доступны зоны: ```block```, ```dmz```, ```drop```, ```external```, ```home```, ```internal```, ```nm-shared```, ```public```, ```trusted```, ```work```.

Посмотрим службы, доступные на компьютере:
```bash
firewall-cmd --get-services
```

![Список доступных служб](image/3.PNG){#fig:003 width=90%}

Определим службы, доступные в текущей зоне:
```bash
firewall-cmd --list-services
```

![Службы для default зоны](image/4.PNG){#fig:004 width=90%}

Для зоны ```public``` доступны службы ```cockpit```, ```dhcppv6-client```, ```ssh```.


Выведем список всех параметров без опции ```--zone``` и с ней.
```bash
firewall-cmd --list-all
firewall-cmd --list-all --zone=public
```

![Параметры текущей зоны и зоны public](image/5.PNG){#fig:005 width=90%}

Как мы видим, параметры одинаковые, так как ```public``` является зоной по умолчанию (ключ ```--list-all``` выводит параметры зоны по умолчанию или же ```default```).

Добавим сервер VNC в конфигурацию брандмауэра и проверим, добавился ли он:
```bash
firewall-cmd --add-service=vnc-server
firewall-cmd --list-all
```

![Вывод параметров после изменений](image/6.PNG){#fig:006 width=90%}

Перезапустим службу firewalld и проверим, что она запущена:
```bash
systemctl restart firewalld
systemctl status firewalld
```

![Перезапуск firewalld.service](image/7.PNG){#fig:007 width=90%}

Проверим, есть ли vnc-server в конфигурации после перезапуска:
```bash
firewall-cmd --list-all
```

![Параметры брандмауэра после перезапуска](image/8.PNG){#fig:008 width=90%}

Служба ```vnc-server``` больше не указана. Это произошло потому, что изменения, внесенные без параметра ```--permanent```, являются временными до перезагрузки службы и не добавляются в конфигурацию.

Добавим службу vnc-server еще раз, но на этот раз сделаем ее постоянной:
```bash
firewall-cmd --add-service=vnc-server --permanent
firewall-cmd --list-all
```

![Добавляем службу, но уже с параметром --permanent](image/9.PNG){#fig:009 width=90%}

VNC-сервер все ещё не указан. Перезагрузим конфигурацию firewalld и просмотрим конфигурацию времени выполнения:
```bash
firewall-cmd --reload
firewall-cmd --list-all
```

![Вывод после добавления постоянного изменения](image/10.PNG){#fig:010 width=90%}

Теперь сервер запущен.

Добавим в конфигурацию порт 2022 протокола TCP, затем перезагрузим брандмауэр:
```bash
firewall-cmd --add-port=2022/tcp --permanent
firewall-cmd --reload
firewall-cmd --list-all
```

![Добавление порта в брандмауэр](image/11.PNG){#fig:011 width=90%}

## Управление брандмауэром с помощью firewall-cmd

Под той же учетной записью (root) установим ```firewall-config``` и запустим его.
```bash
dnf install firewall-config
# или (как в моем случае) из подсказки после ввода firewall-config
```

![Установка firewall-config](image/12.PNG){#fig:012 width=90%}

![GUI службы firewall-config](image/13.PNG){#fig:013 width=90%}

Нажмем выпадающее меню рядом с параметром Configuration. Откроем раскрывающийся список и выберем Permanent. Это позволит сделать все изменения постоянными. Выберем зону public и отметим службы http, https и ftp (в поле Services), чтобы включить их.

Теперь выберем вкладку Ports и на этой вкладке нажмем Add. Введем порт 2022 и укажем протокол udp.

![Добавление порта в брандмауэр](image/14.PNG){#fig:014 width=90%}

Закроем утилиту firewall-config и проверим изменения.
```bash
firewall-cmd --list-all
```

![Конфигурация после работы в графическом редакторе](image/15.PNG){#fig:015 width=90%}

Чтобы изменения вступили в силу, перезагрузим конфигурацию firewalld.
```bash
firewall-cmd --reload
firewall-cmd --list-all
```

![Обновленная конфигурация](image/16.PNG){#fig:016 width=90%}

# Самостоятельная работа

Создадим новую зону для работы. Назовем её ```test```:
```bash
# обязательно укажем параметр --permanent, иначе зона не создастся
firewall-cmd --new-zone=test --permanent
# проверим, добавилась ли зона
firewall-cmd --get-zones
firewall-cmd --reload
firewall-cmd --get-zones
```

![Обновленная конфигурация](image/17.PNG){#fig:017 width=90%}

Добавим службу ```telnet``` в командной строке:
```bash
firewall-cmd --add-service=telnet --zone=test --permanent
```

Теперь откроем графический интерфейс и в нем добавим службы ```imap```, ```pop3``` и ```smtp```.

![GUI службы firewall-config](image/18.PNG){#fig:018 width=90%}

Сменим активную зону интерфейса ```enp0s3``` с ```public``` на ```test```
```bash
firewall-cmd --change-interface=enp0s3 --zone=test --permanent
firewall-cmd --reload
firewall-cmd --list-all
```

![Смена зоны на интерфейсе](image/19.PNG){#fig:019 width=90%}

Так как по умолчанию стоит зона ```public```, выводим параметры с указанием конкретной зоны:
```bash
firewall-cmd --list-all --zone=test
```

![Конфигурация зоны test](image/20.PNG){#fig:020 width=90%}

# Ответы на контрольные вопросы

1. Какая служба должна быть запущена перед началом работы с менеджером конфигурации брандмауэра firewall-config?

- ```firewalld.service```

2. Какая команда позволяет добавить UDP-порт 2355 в конфигурацию брандмауэра в зоне по умолчанию?

- ```firewall-cmd --add-port=2355/udp #--permanent```

3. Какая команда позволяет показать всю конфигурацию брандмауэра во всех зонах?

- ```firewall-cmd --list-all-zones```

4. Какая команда позволяет удалить службу vnc-server из текущей конфигурации брандмауэра?

- ```firewall-cmd --remove-service=vnc-server #--permanent```

5. Какая команда firewall-cmd позволяет активировать новую конфигурацию, добавленную опцией --permanent?

- ```firewall-cmd --reload```

6. Какой параметр firewall-cmd позволяет проверить, что новая конфигурация была добавлена в текущую зону и теперь активна?

- ```firewall-cmd --list-all```

7. Какая команда позволяет добавить интерфейс eno1 в зону public?

- ```firewall-cmd --zone=public --add-interface=eno1 #--permanent```

8. Если добавить новый интерфейс в конфигурацию брандмауэра, пока не указана зона, в какую зону он будет добавлен?

- В зону по умолчанию. Её можно узнать, использовав команду ```firewall-cmd --get-default-zone```

# Вывод

В результате выполнения лабораторной работы я получил навыки работы с брандмауэром службы firewalld, узнал как настраивать и применять конфигурацию для текущей зоны и как упростить конфигурацию с помощью утилиты firewall-config