https://esystem.rudn.ru/pluginfile.php/2843527/mod_resource/content/4/015-partition.pdf
Основы администрирования операционных систем
Лабораторная работа №14. Партиции, файловые системы, монтирование
Отчёт
Сергеев Даниил Олегович
Студент
Направление: Прикладная информатика
Российский университет дружбы народов
06 декабря 2025

# Цель работы

Получить навыки создания разделов на диске и файловых систем. Получить навыки монтирования файловых систем.

# Задание

1. Добавьте два диска на виртуальной машине;
2. Продемонстрируйте навыки создания разделов MBR с помощьюfdisk;
3. Продемонстрируйте навыки создания логических разделов с помощью fdisk;
4. Продемонстрируйте навыки создания раздела подкачки с помощью fdisk;
5. Продемонстрируйте навыки создания разделов GPT с помощью gdisk;
6. Продемонстрируйте навыки форматирования файловой системы XFS;
7. Продемонстрируйте навыки форматирования файловой системы EXT4;
8. Продемонстрируйте навыки ручного монтирования файловых систем;
9. Продемонстрируйте навыки монтирования файловых систем с помощью /etc/fstab;
10. Выполните задание для самостоятельной работы;

# Ход выполнения лабораторной работы

## Создание виртуальных носителей

Добавим к виртуальной системе Rocky Linux два диска размером 512 МБ. Для этого в VirtualBox откроем меню настройки системы и перейдем во вкладку ```Носители```. Добавим новые жёсткие диски для контроллера ```SATA```. В появившемся окне нажмем на кнопку ```Создать файл образа диска```.

![Окно создания образа диска](image/1.PNG){#fig:001 width=90%}

Назовём первый диск ```disk1```, а второй ```disk2```. Укажем тип VDI и память - 512 МБ. После нажмем кнопку ```Создать```. В окне носителей выберем каждый диск по очереди и нажмем кнопку ```Выбрать```, чтобы подключить диски к контроллеру.

![Панель выбора жёсткого диска](image/2.PNG){#fig:002 width=90%}

## Создание разделов MBR с помощью fdisk

Запустим виртуальную машину после добавления дисков. Посмотрим перечень разделов на всех имеющихся в системе устройствах жёстких дисков:
```bash
su -
fdisk --list
```

В списке имеется основной диск ```/dev/sda``` и два новых, размером 512 MiB: ```/dev/sdb``` и ```/dev/sdc```. Они не имеют разделов.

![Перечень разделов на жёстких дисках](image/3.PNG){#fig:003 width=90%}

Пусть нам необходимо сделать разметку разделов для диска ```/dev/sdb```:
```bash
# используем утилиту fdisk
fdisk /dev/sdb
```

![Приветствие программы fdisk](image/4.PNG){#fig:004 width=90%}

Создадим новый основной раздел диска. В качестве первого сектора укажем первый доступный сектор (вариант по умолчанию). Вместо того, чтобы указывать конкретный сектор, введем размер ```100M```. По умолчанию сектор создался с типом системы ```83:Linux```. Чтобы изменения записались на диск, в конце укажем команду ```w```.
```bash
# Создаем новый раздел
n
# Указываем тип раздела (p - основной)
p
# Указываем номер партиции (1 по умолчанию)
# enter
# Указываем первый сектор (по умолчанию)
# enter
# Указываем размер раздела
+100M
# Сохраняем изменения
w
```

![Создание раздела на /dev/sdb](image/5.PNG){#fig:005 width=90%}

![Типы разделов](image/6.PNG){#fig:006 width=90%}

Посмотрим таблицу разделов в памяти ядра и на диске ```/dev/sdb```, сравним их:
```bash
# В файле диска
fdisk -l /dev/sdb
# В памяти ядра
cat /proc/partitions
```

![Таблица разделов в разных командах](image/7.PNG){#fig:007 width=90%}

В файле ```/dev/sdb``` записана информация о параметрах диска: модель, размер, количество и размер секторов. Также указаны разделы диска и их подробная информация, в том числе и новый ```/dev/sdb1```.

В файле ```/proc/partitions``` записан номер устройства (major), номер раздела (minor), количество физических блоков диска (\#blocks) и название.

До записи изменений в таблицу разделов, файл ```/proc/partitions``` не знает об изменениях на дисках (в нем нету информации о /dev/sdb1), поэтому их надо обновить:
```bash
partprobe /dev/sdb
```

## Создание логических разделов

Запустим редактор дисков и создадим новый раздел:
```bash
fdisk /dev/sdb
```

На этот раз выберем расширенный раздел. Так как он должен заполнить всю оставшуюся часть жёсткого диска, в качестве последнего сектора укажем последний (по умолчанию).
```bash
# Создаем новый раздел
n
# Указываем тип (e - расширенный)
e
# Выбираем первый сектор (по умолчанию)
# enter
# Выбираем последний сектор (по умолчанию)
# enter
```

Теперь создадим логический раздел. Утилита сообщит, что пространство для основных разделов занято, поэтому тип нового раздела автоматически станет логическим.

В качестве последнего сектора укажем размер ```101M```.
```bash
# Создаем новый раздел
n
# Выбираем первый сектор (по умолчанию)
# enter
# Выбираем последний сектор (101 MiB)
+101M
# Запишем изменения
w

# Обновляем таблицу разделов ядра
partprobe /dev/sdb
```

![Создание расширенного и логического раздела](image/8.PNG){#fig:008 width=90%}

Выведем информацию о добавленных разделах:
```bash
cat /proc/partitions
# --list == -l
fdisk --list /dev/sdb
```

![Информация о /dev/sdb2 и /dev/sdb5](image/9.PNG){#fig:009 width=90%}

Разделы успешно добавились

## Создание раздела подкачки

Запустим утилиту:
```bash
fdisk /dev/sdb
```

Создадим раздел аналогичный ```/dev/sdb1```, но перед записью укажем тип раздела ```82:Linux swap```.
```bash
# Создаем новый раздел (6 по умолчанию)
n
# Указываем первый сектор (по умолчанию)
# enter
# Указываем размер раздела (100 MiB)
+100M
# Режим изменения типа раздела
t
# Указываем номер партиции (предлагается 6 по умолчанию)
# enter или 6
# Указываем код раздела подкачки
82
# Сохраняем изменения
w

# Обновляем таблицу разделов ядра
partprobe /dev/sdb
```

![Создание раздела подкачки](image/10.PNG){#fig:010 width=90%}

Выведем информацию о добавленных разделах:
```bash
cat /proc/partitions
# --list == -l
fdisk --list /dev/sdb
```

![Информация о /dev/sdb6](image/11.PNG){#fig:011 width=90%}

Разделы успешно добавились. Теперь отформатируем раздел подкачки и включим выделенное пространство:
```bash
mkswap /dev/sdb6
swapon /dev/sdb6
```

Просмотрим размер пространства подкачки:
```bash
free -m
```

![Форматирование /dev/sdb6 и размер пространства подкачки](image/12.PNG){#fig:012 width=90%}

## Создание разделов GPT с помощью gdisk

Посмотрим таблицы разделов и разделы на втором диске ```/dev/sdc```:
```bash
# Теперь используем gdisk
gdisk -l /dev/sdc
```

![Создание таблицы разделов GPT](image/13.PNG){#fig:013 width=90%}

Так как разбиение диска отсутствует, создаётся таблица разделов GPT и соответствующее разбиение в памяти.

Теперь создадим раздел с помощью ```gdisk```:
```bash
# Создаем раздел
n
# Указываем номер партиции (1 по умолчанию)
# enter
# Указываем первый сектор (по умолчанию)
# enter
# Указываем размер раздела (100 MiB)
+100M
```

![Создание раздела через gdisk](image/14.PNG){#fig:014 width=90%}

В отличие от ```fdisk```, нам предлагается указать тип разбиения. Указываем значение по умолчанию (8300). После создания раздела выведем разбиение диска:
```bash
# Указываем тип раздела по умолчанию (8300)
# enter
# Отображаем разбиение диска
p
# Сохраняем изменения на диск
w

# Обновляем таблицу разделов
partprobe /dev/sdc
```

![Завершение редактирования в gdisk](image/15.PNG){#fig:015 width=90%}

Выведем информацию о добавленных разделах:
```bash
cat /proc/partitions
gdisk -l /dev/sdc
```

![Информация о /dev/sdc (1)](image/16.PNG){#fig:016 width=90%}

![Информация о /dev/sdc (2)](image/17.PNG){#fig:017 width=90%}

Разделы успешно добавились.

## Форматирование файловой системы XFS

В терминале для ```/dev/sdb1``` создадим файловую систему ```XFS```:
```bash
mkfs.xfs /dev/sdb1
```

Установим метку файловой системы в ```xfsdisk```:
```bash
xfs_admin -L xfsdisk /dev/sdb1
```

![Форматирование файловой системы XFS](image/18.PNG){#fig:018 width=90%}

## Форматирование файловой системы EXT4

Создадим файловую систему ```EXT4``` для ```/dev/sdb5```:
```bash
mkfs.ext4 /dev/sdb5
```

Установим метку файловой системы в ext4disk:
```bash
tune2fs -L ext4disk /dev/sdb5
```

Установим параметры монтирования по умолчанию для файловой системы:
```bash
tune2fs -o acl,user_xattr /dev/sdb5
```

![Форматирование файловой системы EXT4](image/19.PNG){#fig:019 width=90%}

## Ручное монтирование файловых систем

Создадим раздел точки монтирования:
```bash
mkdir -p /mnt/tmp
```

Смонтируем файловую систему /dev/sdb5 в точке и проверим корректность монтирования:
```bash
# mount <система> <точка монтирования>
mount /dev/sdb5 /mnt/tmp

mount
```

![Монтирование файловой системы EXT4 /dev/sdb5 вручную](image/20.PNG){#fig:020 width=90%}

Чтобы отмонтировать раздел, используем umount с именем устройства и с точкой монтирования:
```bash
umount /dev/sdb5
mount | grep sdb5

mount /dev/sdb5 /mnt/tmp
mount | grep sdb5

umount /mnt/tmp
mount | grep sdb5
```

![Отмонтирование раздела вручную](image/21.PNG){#fig:021 width=90%}

## Монтирование разделов с помощью /etc/fstab

Создадим раздел точки монтирования:
```bash
mkdir /mnt/data
# если mnt не существует: mkdir -p /mnt/data 
```

Посмотрим информацию об идентификаторах блочных устройств (UUID):
```bash
blkid
```

Теперь посмотрим информацию о конкретном устройстве (```/dev/sdb1```):
```bash
blkid /dev/sdb1
```

![Работа с blkid](image/22.PNG){#fig:022 width=90%}

Скопируем UUID для этого устройства. Откроем файл ```/etc/fstab``` на редактирование и добавим в него строку:
```bash
vi /etc/fstab

# В файле
UUID=9a335330-c2fc-4054-9f54-c3e288abec4b /mnt/data xfs defaults 1 2
```

Монтируем всё, что указано в ```/etc/fstab``` и проверим, что раздел примонтирован правильно:
```bash
mount -a
df -h
```

![Проверка конфигурации /etc/fstab](image/23.PNG){#fig:023 width=90%}

# Самостоятельная работа

Добавим два раздела по 100 MiB на диск ```/dev/sdb``` (через ```gdisk```).

![Создание раздела подкачки](image/24.PNG){#fig:024 width=90%}

![Создание раздела для файловой системы EXT4](image/25.PNG){#fig:025 width=90%}

![Текущее разбиение](image/26.PNG){#fig:026 width=90%}

Сохраним изменения, нажав ```w```, и обновим таблицу разделов.
```bash
partprobe /dev/sdb
cat /proc/partitions
```

![Обновление таблицы разделов](image/27.PNG){#fig:027 width=90%}

Форматируем и подключим ```/dev/sdb2``` (раздел подкачки) и ```/dev/sdb3``` (EXT4):
```bash
mkswap /dev/sdb2
swapon /dev/sdb2
# Проверим пространство подкачки
free -m

mkfs.ext4 /dev/sdb3
```

![Форматирование sdb2 и sdb3](image/28.PNG){#fig:028 width=90%}

Создадим каталог для автоматического монтирования ```/dev/sdb3```:
```bash
mkdir -p /mnt/data-ext4
ls -l /mnt
```

Узнаем UUID для разделов и запишем их в автозапуск:
```bash
blkid {/dev/sdb2,/dev/sdb3}
vi /etc/fstab

# В файле
UUID=d6c03b3a-38e2-475d-9a02-0511f91c2d15 none swap defaults 0 0
UUID=92d184d4-8469-4307-975f-34218851c48c /mnt/data-ext ext4 defaults 1 2
```

![Редактирование /etc/fstab](image/29.PNG){#fig:029 width=90%}

Монитруем, чтобы проверить конфигурацию:
```bash
mount -a
df -h
```

![Провверка конфигурации в самостоятельной работе](image/30.PNG){#fig:030 width=90%}

Перезагрузим систему и убедимся, что все правильно:
```bash
su - 
df -h
free -h
# подробный размер
free -m
```

![Проверка монтирования после перезагрузки](image/31.PNG){#fig:031 width=90%}

После перезагрузки файловая система sdb поменяла своё название на sdc.

# Ответы на контрольные вопросы

1. Какой инструмент используется для создания разделов GUID?

- ```gdisk```

2. Какой инструмент применяется для создания разделов MBR?

- ```fdisk```

3. Какой файл используется для автоматического монтирования разделов во время загрузки?

- ```/etc/fstab```

4. Какой вариант монтирования целесообразно выбрать, если необходимо, чтобы файловая система не была автоматически примонтирована во время загрузки?

- В ```/etc/fstab``` добавить опцию ```noauto``` в поле параметров монтирования

5. Какая команда позволяет форматировать раздел с типом 82 с соответствующей файловой системой?

- ```mkswap /dev/диск``` - форматировать;
- ```swapon /dev/диск``` - подключить после форматирования;

6. Вы только что добавили несколько разделов для автоматического монтирования при загрузке. Как можно безопасно проверить, будет ли это работать без реальной перезагрузки?

- ```mount -a``` - монтирует все из /etc/fstab;
- ```df -h``` - выводит информацию о пространстве в файловых системах;

7. Какая файловая система создаётся, если вы используете команду mkfs без какой-либо спецификации файловой системы?

- ```EXT2```

8. Как форматировать раздел EXT4?

- ```mkfs.ext4 /dev/диск```

9. Как найти UUID для всех устройств на компьютере?

- ```blkid```

# Вывод

В результате выполнения лабораторной работы я получил навыки по созданию и настройке разделов на диске и файловых систем, узнал как монтировать и форматировать файловые системы, а также как правильно редактировать автоматическое монтирование систем после перезагрузки.